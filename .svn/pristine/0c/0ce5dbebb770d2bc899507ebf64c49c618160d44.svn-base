<template>
    <section class='my-download-page'>
        <section
             @click="wxOpen = false"
             v-if="wxOpen" 
             class="my-download-page__img-box">
            <!-- <img src="https://res.squrab.com/download/wechat-ua.png" alt="bg__sfare"> -->
        </section>
        <section class="my-download-page__btn-area">
            <section @click="handleClick" class="my-download-page__btn-area--box">
                <img v-if="isShowBtn" :src="btnImgs[0]" alt="ios">
                <img v-else :src="btnImgs[1]" alt="ios">
            </section>
        </section>
    </section>
</template>

<script> 
 import axios from 'axios'
 const btnImgs = [
     'https://res.squrab.com/web/download/btn_ios.png',
     'https://res.squrab.com/web/download/btn_android.png'
 ]
 export default{
    name: 'MyDownload',
    data(){
        return {
            isShowBtn: 1,
            btnImgs,
            reLoadUrl: '',
            wxOpen: false
        }
    },
    methods: {
        getUserAgent(){
            axios({
                method: 'get',
                url: 'https://asapi.squrab.com/api/app/url'
            }).then(res => {
                let {info, list} = res.data.data
                if(info.Mobile && info.Version.toLocaleLowerCase() == 'ios') {
                    this.isShowBtn = 1
                    this.reLoadUrl = list.app.find(kk => kk.app_type == 7).download_path
                }else if(info.Mobile && info.Version.toLocaleLowerCase() == 'android') {
                    this.isShowBtn = 0
                    this.reLoadUrl = list.app.find(kk => kk.app_type == 6).download_path
                }
            })
        },
        handleClick(){
            let userAgent = window.navigator.userAgent.toLowerCase()
            if(userAgent.match(/MicroMessenger/i) == 'micromessenger') {
                this.wxOpen = true
            }else {
                window.location.href = this.reLoadUrl
            }
        },
    },
    created(){
        this.getUserAgent()
    },
    mixins: []
 }
</script>

<style scoped lang='scss'>
@import '@/assets/style/mixin.scss';

@include b(download-page) {
    position: relative;
    width: 100%;
    height: 100%;
    background-image: url(../../assets/imgs/mobile/bg_group.png);
    background-size: 100% 100%;
    background-position: center center;
    @include e(img-box) {
        position: absolute;
        left: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        z-index: 1000;

        background-image: url('https://res.squrab.com/download/wechat-ua.png');
        background-size: 100% 100%;
        background-position: center center;
    }
    @include e(btn-area) {
        position: absolute;
        bottom: 5vh;
        width: 80vw;
        left: 10vw;
        overflow: hidden;

        @include m(box) {
            width: 100%;
            height: 100%;

            & > img {
                width: auto;
                max-width: 100%;
            }
        }
    }
}
</style>